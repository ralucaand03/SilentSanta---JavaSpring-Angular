<div class="page">
  <div class="requests-container">
    <!-- Header -->
    <div class="requests-header">
      <h1 class="page-title">My Letter Requests</h1>
      <p class="page-description">Track the status of letters you've requested to fulfill.</p>
    </div>
    
    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Loading your requests...</p>
    </div>
    
    <!-- Error Message -->
    <div class="error-message" *ngIf="errorMessage">
      <p>{{ errorMessage }}</p>
    </div>
    
    <!-- Success Message -->
    <div class="success-message" *ngIf="successMessage">
      <p>{{ successMessage }}</p>
    </div>
    
    <!-- User Requests Section -->
    <div class="section">
      <h2 class="section-title">My Requested Letters</h2>
      
      <div class="requests-list">
        <div class="requests-empty" *ngIf="userRequests.length === 0 && !isLoading">
          <div class="empty-state">
            <i class="icon-mail-large"></i>
            <h3>No letter requests</h3>
            <p>You haven't requested any letters yet.</p>
            <button class="primary-button" routerLink="/letters">Browse Letters</button>
          </div>
        </div>
        
        <div class="request-card" *ngFor="let request of userRequests">
          <div class="request-header">
            <div class="request-header-content">
              <h2 class="child-name">{{ request.childName }}, {{ request.childAge }}</h2>
              <div class="request-badges">
                <span class="gender-badge" [class]="request .gender">
                  <i [class]="'icon-' + request .gender"></i>
                </span>
                <span class="location-badge">{{ request .location }}</span>
                <span class="status-badge" [class]="request.status.toLowerCase()">
                  {{ request.status }}
                </span>
              </div>
            </div>
          </div>
          
          <div class="request-content">
            <h3 class="wishes-title">Christmas Wishes:</h3>
            <ul class="wishes-list">
              <li *ngFor="let item of request.wishList">{{ item }}</li>
            </ul>
          </div>
          
          <div class="request-footer">
            <button 
              class="cancel-button" 
              *ngIf="request.status === 'WAITING'"
              (click)="cancelRequest(request)">
              Cancel Request
            </button>
            <div class="status-message" [class]="request.status.toLowerCase()">
              <ng-container [ngSwitch]="request.status">
                <span *ngSwitchCase="'WAITING'">Your request is pending approval</span>
                <span *ngSwitchCase="'ACCEPTED'">Your request has been accepted!</span>
                <span *ngSwitchCase="'DENIED'">Your request has been denied</span>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Admin Section - Requests from Users -->
    <div class="section" *ngIf="isAdmin">
      <h2 class="section-title">Requested by Users</h2>
      
      <div class="requests-list">
        <div class="requests-empty" *ngIf="letterOwnerRequests.length === 0 && !isLoading">
          <div class="empty-state">
            <i class="icon-mail-large"></i>
            <h3>No incoming requests</h3>
            <p>You don't have any requests for your letters yet.</p>
          </div>
        </div>
        
        <div class="request-card" *ngFor="let request of letterOwnerRequests">
          <div class="request-header">
            <div class="request-header-content">
              <h2 class="child-name">{{ request.childName }}, {{ request.childAge }}</h2>
              <div class="request-badges">
                <span class="gender-badge" [class]="request.gender">
                  <i [class]="'icon-' + request.gender"></i>
                </span>
                <span class="location-badge">{{ request.location }}</span>
                <span class="status-badge" [class]="request.status.toLowerCase()">
                  {{ request.status }}
                </span>
              </div>
            </div>
          </div>
          
          <div class="request-content">
            <h3 class="requester-info">Requested by:</h3>
            <!-- <p class="requester-name">{{ request.firstName }} {{ request.lastName }}</p>
            <p class="requester-email">{{ request.email }}</p> -->
            
            <h3 class="wishes-title">Christmas Wishes:</h3>
            <ul class="wishes-list">
              <li *ngFor="let item of request.wishList">{{ item }}</li>
            </ul>
          </div>
          
          <div class="request-footer">
            <div class="action-buttons" *ngIf="request.status === 'WAITING'">
              <button 
                class="accept-button" 
                (click)="updateRequestStatus(request, 'ACCEPTED')">
                Accept
              </button>
              <button 
                class="deny-button" 
                (click)="updateRequestStatus(request, 'DENIED')">
                Deny
              </button>
            </div>
            <div class="status-message" [class]="request.status.toLowerCase()">
              <ng-container [ngSwitch]="request.status">
                <span *ngSwitchCase="'WAITING'">
                  User requested this letter
                </span>
                <span *ngSwitchCase="'ACCEPTED'">You've accepted this request</span>
                <span *ngSwitchCase="'DENIED'">You've denied this request</span>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
